<!-- ////////////// SOCKET.IO - GLOBAL RELOAD ////////////////-->

<script src="/socket.io/socket.io.js"></script>

<script>
    const socketOptions = {};
  <% if (typeof currentUser !== 'undefined') { %>
        socketOptions.query = { username: '<%= currentUser.username %>' };
  <% } %>
  const socket = io(socketOptions);

    socket.on('connect', () => {
        console.log('SOCKET.IO - Connected to server');
    });

    socket.on('disconnect', () => {
        console.log('SOCKET.IO - Disconnected from server');
    });

    socket.on('reload', () => {
        console.log('Reload event received');
        setTimeout(() => location.reload(), 100);
    });

    socket.on('userCount', (count) => {
        document.querySelector('#userCount').innerText = count;
    });

    socket.on('userList', (users) => {
    const userList = document.querySelector('#userList');
    userList.innerHTML = '';
    
    const onlineItem = document.createElement('li');
    onlineItem.innerText = 'Online:';
    userList.appendChild(onlineItem);

    const hrItem = document.createElement('li');
    hrItem.innerHTML = '<hr>';
    userList.appendChild(hrItem);

    users.forEach((user) => {
        const listItem = document.createElement('li');
        listItem.innerText = user;
        userList.appendChild(listItem);
    });
});
</script>