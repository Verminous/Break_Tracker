<style>
    .logFile {
        cursor: pointer;
        color: blue;
        text-decoration: underline;
    }
</style>

<h1>Logs</h1>
<div id="logList">
    <% logs.forEach(logFile=> { %>
        <div class="logFile" onclick="fetchLogContent('<%= logFile %>')">
            <%= logFile %>
        </div>
        <% }); %>
</div>
<h2>Log content</h2>
<pre id="logContent"></pre>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        // Fetch list of log files
        fetch('/logs')
            .then(response => {
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                return response.json();
            })
            .then(data => {
                const logList = document.getElementById('logList');

                data.logs.forEach(logFile => {
                    const div = document.createElement('div');
                    div.className = 'logFile';
                    div.textContent = logFile;

                    // Fetch log content when clicked
                    div.addEventListener('click', function () {
                        fetchLogContent(logFile);
                    });

                    logList.appendChild(div);
                });
            }).catch(e => {
                console.error("Error fetching log files:", e);
            });
    });

    function fetchLogContent(logFile) {
        fetch(`/logs/${logFile}`)
            .then(response => {
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                return response.json();
            })
            .then(data => {
                document.getElementById('logContent').textContent = data.data;
            })
            .catch(error => {
                console.error('Error fetching log content:', error);
            });
    }
</script>
